(self.webpackChunk=self.webpackChunk||[]).push([["wbm-tag-manager-analytics"],{8553:(e,t,o)=>{"use strict";o.d(t,{Du:()=>l,UK:()=>d,ZP:()=>u});var s=o(6285),i=o(7606),n=o(2615),r=o(3637),a=o(8254),c=o(4690);const l="CookieConfiguration_Update",d="CookieConfiguration_CloseOffCanvas";class u extends s.Z{init(){this.lastState={active:[],inactive:[]},this._httpClient=new a.Z,this._registerEvents()}_registerEvents(){const{submitEvent:e,buttonOpenSelector:t,customLinkSelector:o,globalButtonAcceptAllSelector:s}=this.options;Array.from(document.querySelectorAll(t)).forEach((t=>{t.addEventListener(e,this.openOffCanvas.bind(this))})),Array.from(document.querySelectorAll(o)).forEach((t=>{t.addEventListener(e,this._handleCustomLink.bind(this))})),Array.from(document.querySelectorAll(s)).forEach((t=>{t.addEventListener(e,this._acceptAllCookiesFromCookieBar.bind(this))}))}_registerOffCanvasEvents(){const{submitEvent:e,buttonSubmitSelector:t,buttonAcceptAllSelector:o,wrapperToggleSelector:s}=this.options,n=this._getOffCanvas();if(n){const r=n.querySelector(t),a=n.querySelector(o),c=Array.from(n.querySelectorAll('input[type="checkbox"]')),l=Array.from(n.querySelectorAll(s));r&&r.addEventListener(e,this._handleSubmit.bind(this,i.Z)),a&&a.addEventListener(e,this._acceptAllCookiesFromOffCanvas.bind(this,i.Z)),c.forEach((t=>{t.addEventListener(e,this._handleCheckbox.bind(this))})),l.forEach((t=>{t.addEventListener(e,this._handleWrapperTrigger.bind(this))}))}}_handleCustomLink(e){e.preventDefault(),this.openOffCanvas()}_handleUpdateListener(e,t){const o=this._getUpdatedCookies(e,t);document.$emitter.publish(l,o)}_getUpdatedCookies(e,t){const{lastState:o}=this,s={};return e.forEach((e=>{o.inactive.includes(e)&&(s[e]=!0)})),t.forEach((e=>{o.active.includes(e)&&(s[e]=!1)})),s}openOffCanvas(e){const{offCanvasPosition:t}=this.options,o=window.router["frontend.cookie.offcanvas"];this._hideCookieBar(),n.Z.open(o,!1,this._onOffCanvasOpened.bind(this,e),t)}closeOffCanvas(e){n.Z.close(),"function"==typeof e&&e()}_onOffCanvasOpened(e){this._registerOffCanvasEvents(),this._setInitialState(),this._setInitialOffcanvasState(),PluginManager.initializePlugins(),"function"==typeof e&&e()}_hideCookieBar(){const e=PluginManager.getPluginInstances("CookiePermission");e&&e[0]&&(e[0]._hideCookieBar(),e[0]._removeBodyPadding())}_setInitialState(e=null){const t=e||this._getCookies("all"),o=[],s=[];t.forEach((({cookie:e,required:t})=>{i.Z.getItem(e)||t?o.push(e):s.push(e)})),this.lastState={active:o,inactive:s}}_setInitialOffcanvasState(){const e=this.lastState.active,t=this._getOffCanvas();e.forEach((e=>{const o=t.querySelector(`[data-cookie="${e}"]`);o.checked=!0,this._childCheckboxEvent(o)}))}_handleWrapperTrigger(e){e.preventDefault();const{entriesActiveClass:t,entriesClass:o,groupClass:s}=this.options,{target:i}=e,n=this._findParentEl(i,o,s);if(n){n.classList.contains(t)?n.classList.remove(t):n.classList.add(t)}}_handleCheckbox(e){const{parentInputClass:t}=this.options,{target:o}=e;(o.classList.contains(t)?this._parentCheckboxEvent:this._childCheckboxEvent).call(this,o)}_findParentEl(e,t,o=null){for(;e&&!e.classList.contains(o);){if(e.classList.contains(t))return e;e=e.parentElement}return null}_isChecked(e){return!!e.checked}_parentCheckboxEvent(e){const{groupClass:t}=this.options,o=this._isChecked(e),s=this._findParentEl(e,t);this._toggleWholeGroup(o,s)}_childCheckboxEvent(e){const{groupClass:t}=this.options,o=this._isChecked(e),s=this._findParentEl(e,t);this._toggleParentCheckbox(o,s)}_toggleWholeGroup(e,t){Array.from(t.querySelectorAll("input")).forEach((t=>{t.checked=e}))}_toggleParentCheckbox(e,t){const{parentInputSelector:o}=this.options,s=Array.from(t.querySelectorAll(`input:not(${o})`)),i=Array.from(t.querySelectorAll(`input:not(${o}):checked`));if(s.length>0){const e=t.querySelector(o);if(e){const t=i.length>0,o=t&&i.length!==s.length;e.checked=t,e.indeterminate=o}}}_handleSubmit(){const e=this._getCookies("active"),t=this._getCookies("inactive"),{cookiePreference:o}=this.options,s=[],n=[];t.forEach((({cookie:e})=>{n.push(e),i.Z.getItem(e)&&i.Z.removeItem(e)})),e.forEach((({cookie:e,value:t,expiration:o})=>{s.push(e),e&&t&&i.Z.setItem(e,t,o)})),i.Z.setItem(o,"1","30"),this._handleUpdateListener(s,n),this.closeOffCanvas(document.$emitter.publish(d))}acceptAllCookies(e=!1){if(!e)return this._handleAcceptAll(),void this.closeOffCanvas();c.Z.create(this.el);const t=window.router["frontend.cookie.offcanvas"];this._httpClient.get(t,(e=>{const t=(new DOMParser).parseFromString(e,"text/html");this._handleAcceptAll(t),c.Z.remove(this.el),this._hideCookieBar()}))}_acceptAllCookiesFromCookieBar(){return this.acceptAllCookies(!0)}_acceptAllCookiesFromOffCanvas(){return this.acceptAllCookies()}_handleAcceptAll(e=null){const t=this._getCookies("all",e);this._setInitialState(t);const{cookiePreference:o}=this.options;t.forEach((({cookie:e,value:t,expiration:o})=>{e&&t&&i.Z.setItem(e,t,o)})),i.Z.setItem(o,"1","30"),this._handleUpdateListener(t.map((({cookie:e})=>e)),[])}_getCookies(e="all",t=null){const{cookieSelector:o}=this.options;return t||(t=this._getOffCanvas()),Array.from(t.querySelectorAll(o)).filter((t=>{switch(e){case"all":return!0;case"active":return this._isChecked(t);case"inactive":return!this._isChecked(t);default:return!1}})).map((e=>{const{cookie:t,cookieValue:o,cookieExpiration:s,cookieRequired:i}=e.dataset;return{cookie:t,value:o,expiration:s,required:i}}))}_getOffCanvas(){const e=r.Z?r.Z.getOffCanvas():[];return!!(e&&e.length>0)&&e[0]}}var h,f,m;h=u,f="options",m={offCanvasPosition:"left",submitEvent:"click",cookiePreference:"cookie-preference",cookieSelector:"[data-cookie]",buttonOpenSelector:".js-cookie-configuration-button button",buttonSubmitSelector:".js-offcanvas-cookie-submit",buttonAcceptAllSelector:".js-offcanvas-cookie-accept-all",globalButtonAcceptAllSelector:".js-cookie-accept-all-button",wrapperToggleSelector:".offcanvas-cookie-entries span",parentInputSelector:".offcanvas-cookie-parent-input",customLinkSelector:`[href="${window.router["frontend.cookie.offcanvas"]}"]`,entriesActiveClass:"offcanvas-cookie-entries--active",entriesClass:"offcanvas-cookie-entries",groupClass:"offcanvas-cookie-group",parentInputClass:"offcanvas-cookie-parent-input"},(f=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var s=o.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(f))in h?Object.defineProperty(h,f,{value:m,enumerable:!0,configurable:!0,writable:!0}):h[f]=m},2615:(e,t,o)=>{"use strict";o.d(t,{Z:()=>a});var s=o(3637),i=o(8254),n=o(7906);let r=null;class a extends s.Z{static open(e=!1,t=!1,o=null,i="left",n=!0,r=s.Z.REMOVE_OFF_CANVAS_DELAY(),a=!1,c=""){if(!e)throw new Error("A url must be given!");s.r._removeExistingOffCanvas();const l=s.r._createOffCanvas(i,a,c,n);this.setContent(e,t,o,n,r),s.r._openOffcanvas(l)}static setContent(e,t,o,s,c){const l=new i.Z;super.setContent(`<div class="offcanvas-body">${n.Z.getTemplate()}</div>`,s,c),r&&r.abort();const d=e=>{super.setContent(e,s,c),"function"==typeof o&&o(e)};r=t?l.post(e,t,a.executeCallback.bind(this,d)):l.get(e,a.executeCallback.bind(this,d))}static executeCallback(e,t){"function"==typeof e&&e(t),window.PluginManager.initializePlugins()}}},3637:(e,t,o)=>{"use strict";o.d(t,{Z:()=>d,r:()=>l});var s=o(9658),i=o(2005),n=o(1966);const r="offcanvas",a=350;class c{constructor(){this.$emitter=new i.Z}open(e,t,o,s,i,n,r){this._removeExistingOffCanvas();const a=this._createOffCanvas(o,n,r,s);this.setContent(e,s,i),this._openOffcanvas(a,t)}setContent(e,t,o){const s=this.getOffCanvas();s[0]&&(s[0].innerHTML=e,this._registerEvents(o))}setAdditionalClassName(e){this.getOffCanvas()[0].classList.add(e)}getOffCanvas(){return document.querySelectorAll(`.${r}`)}close(e){const t=this.getOffCanvas();n.Z.iterate(t,(e=>{bootstrap.Offcanvas.getInstance(e).hide()})),setTimeout((()=>{this.$emitter.publish("onCloseOffcanvas",{offCanvasContent:t})}),e)}goBackInHistory(){window.history.back()}exists(){return this.getOffCanvas().length>0}_openOffcanvas(e,t){c.bsOffcanvas.show(),window.history.pushState("offcanvas-open",""),"function"==typeof t&&t()}_registerEvents(e){const t=s.Z.isTouchDevice()?"touchend":"click",o=this.getOffCanvas();n.Z.iterate(o,(t=>{const s=()=>{setTimeout((()=>{t.remove(),this.$emitter.publish("onCloseOffcanvas",{offCanvasContent:o})}),e),t.removeEventListener("hide.bs.offcanvas",s)};t.addEventListener("hide.bs.offcanvas",s)})),window.addEventListener("popstate",this.close.bind(this,e),{once:!0});const i=document.querySelectorAll(".js-offcanvas-close");n.Z.iterate(i,(o=>o.addEventListener(t,this.close.bind(this,e))))}_removeExistingOffCanvas(){c.bsOffcanvas=null;const e=this.getOffCanvas();return n.Z.iterate(e,(e=>e.remove()))}_getPositionClass(e){return"left"===e?"offcanvas-start":"right"===e?"offcanvas-end":`offcanvas-${e}`}_createOffCanvas(e,t,o,s){const i=document.createElement("div");if(i.classList.add(r),i.classList.add(this._getPositionClass(e)),!0===t&&i.classList.add("is-fullwidth"),o){const e=typeof o;if("string"===e)i.classList.add(o);else{if(!Array.isArray(o))throw new Error(`The type "${e}" is not supported. Please pass an array or a string.`);o.forEach((e=>{i.classList.add(e)}))}}return document.body.appendChild(i),c.bsOffcanvas=new bootstrap.Offcanvas(i,{backdrop:!1!==s||"static"}),i}}const l=Object.freeze(new c);class d{static open(e,t=null,o="left",s=!0,i=350,n=!1,r=""){l.open(e,t,o,s,i,n,r)}static setContent(e,t=!0,o=350){l.setContent(e,t,o)}static setAdditionalClassName(e){l.setAdditionalClassName(e)}static close(e=350){l.close(e)}static exists(){return l.exists()}static getOffCanvas(){return l.getOffCanvas()}static REMOVE_OFF_CANVAS_DELAY(){return a}}},2893:(e,t,o)=>{"use strict";var s,i,n,r=o(9068),a=o(6285),c=o(3206);function l(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var s=o.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class d{constructor(){l(this,"items",null)}static setImpressions(e){e&&(this.items=e.ecommerce.items),null!==this.items&&0!==this.items.length||console.info("no items found in dataLayer")}static getProductFromImpressions(e){const t=this.items.find(((t,o)=>t.item_id===e));if(void 0===t)throw new u("product not found in items");return t}}class u extends Error{constructor(e){super(e),this.name="InvalidImpressionsError"}}class h{static getProductNoFromProductDetail(){return c.Z.querySelector(document,'[itemprop="sku"]').innerText}static getProductNoFromProductBox(e){const t=e.closest(".product-box");return c.Z.querySelector(t,'[name="sku"]').value}}class f extends a.Z{init(){"undefined"!=typeof gtmIsTrackingProductClicks&&!0===gtmIsTrackingProductClicks&&this._registerEvents()}_registerEvents(){const e=this;this.el.addEventListener("click",(t=>{e.onProductClicked(t)}))}onProductClicked(e){if(!this.el.dataset.hasOwnProperty("addToWishlist")||!this.el.dataset.addToWishlist){c.Z.hasAttribute(this.el,"href")&&e.preventDefault();try{const e=this._getProduct();window.dataLayer.push({event:"select_item",ecommerce:{items:[e]}})}catch(e){console.info(e)}this._shouldRedirect(e)&&(document.location=c.Z.getAttribute(this.el,"href"))}}_getProduct(){const e=h.getProductNoFromProductBox(this.el);return d.getProductFromImpressions(e)}_shouldRedirect(e){let t=!1;c.Z.hasAttribute(this.el,"href")&&(t=!0),e.target.classList.contains("btn-buy")&&(t=!1);const o='[data-swag-cms-extensions-quickview="true"]';return(null!==this.el.closest(".cms-section")&&null!==this.el.closest(".cms-section").querySelector(o)||document.body.classList.contains("is-ctl-search")&&null!==this.el.closest(".container-main")&&null!==this.el.closest(".container-main").querySelector(o))&&(t=!1),t}}class m extends a.Z{init(){"undefined"!=typeof gtmIsTrackingAddToWishlistClicks&&!0===gtmIsTrackingAddToWishlistClicks&&(this._registerEvents(),this.el.dataset.isAdded=this.el.classList.contains("product-wishlist-added").toString())}_registerEvents(){const e=this;this.el.addEventListener("click",(t=>{e._onAddToWishlistClicked(t)}))}_onAddToWishlistClicked(){try{if(this.el.classList.contains("product-wishlist-not-added"))return;const e=this._getProduct();window.dataLayer.push({event:"add_to_wishlist",ecommerce:{items:[e]}})}catch(e){console.info(e)}}_getProduct(){const e=document.body.classList.contains("is-ctl-product")?h.getProductNoFromProductDetail():h.getProductNoFromProductBox(this.el);return d.getProductFromImpressions(e)}}class p extends a.Z{init(){if(!window.wbmScriptIsSet)return;const e=this;let t=!1;try{t=c.Z.querySelectorAll(this.el,"[data-promotion]")}catch(e){return}this.promotions=[],t.forEach((t=>{e.registerEvent(t)})),this.pushPromoView()}registerEvent(e){const t=this;try{c.Z.querySelectorAll(e,"a, area").forEach((e=>{const o=JSON.parse(JSON.stringify(e.dataset));void 0===o.promotionId&&"undefinded"===o.promotionName||(t.addPromotion(o),e.addEventListener("click",(s=>{t.onPromotionClicked(s,e,o)})))}))}catch(e){}}onPromotionClicked(e,t,o){e.preventDefault(),dataLayer.push({event:"promotionClick",ecommerce:{promoClick:{promotions:[{id:o.promotionId||"",name:o.promotionName||"",creative:o.promotionCreative||"",position:o.promotionPosition||""}]}},eventCallback:function(){document.location=c.Z.getAttribute(t,"href")}})}addPromotion(e){const t={id:e.promotionId||"",name:e.promotionName||"",creative:e.promotionCreative||"",position:e.promotionPosition||""};this.promotions.push(t)}pushPromoView(){this.promotions.length>0&&window.dataLayer.push({event:"promotions",ecommerce:{promoView:{promotions:this.promotions}}})}}class v{static push(e){if(e.ecommerce&&e.ecommerce.items&&(e.ecommerce.items=e.ecommerce.items.filter((e=>!e.item_id.includes("free-product-")))),window.dataLayer.push({ecommerce:null}),!e.hasOwnProperty("ecommerce")||!e.ecommerce.hasOwnProperty("items")||!e.hasOwnProperty("event"))return void window.dataLayer.push(e);d.setImpressions(e),v.event=e.event;const t=(new TextEncoder).encode(JSON.stringify(e)).length/1024;if(Math.ceil(t)<=7)return void window.dataLayer.push(e);const o=e.ecommerce.items,s=e.ecommerce;let i=1,n=v.createEmptyDataLayer(s,i),r=[];for(let e=0;e<o.length;e++)r.push(o[e]),(e+1)%8==0&&(v.pushSubset(n,r),i++,n=v.createEmptyDataLayer(s,i),r=[]);r.length>0&&v.pushSubset(n,r)}static pushSubset(e,t){e.ecommerce.items=t,window.dataLayer.push(e)}static createEmptyDataLayer(e,t){const o={};return o.event=v.event,o.ecommerce=e,o.ecommerce.subset=t,o.ecommerce.items=[],o}}s=v,n="",(i=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var s=o.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(i="event"))in s?Object.defineProperty(s,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[i]=n,"undefined"!=typeof onEventDataLayer&&window.addEventListener("load",(function(){v.push(onEventDataLayer)}));o(8879);var g=o(8553);document.$emitter.subscribe(g.Du,(function(e){if(void 0!==e.detail["wbm-tagmanager-enabled"]&&e.detail["wbm-tagmanager-enabled"]&&!window.wbmScriptIsSet){const e=document.getElementById("wbmTagManger");if(void 0===e)return;const t=document.createElement("script"),o=document.createTextNode(`(${window.googleTag})(window,document,'script','dataLayer', '${window.wbmGoogleTagmanagerId}');`);t.appendChild(o),e.parentNode.insertBefore(t,e.nextSibling),window.wbmScriptIsSet=!0,window.googleTag=null}})),r.Z.register("ProductClickTracking",f,".product-box a",{parent:".product-box"}),r.Z.register("ProductClickTracking",f,".product-box button",{parent:".product-box"}),r.Z.register("AddToWishlistTracking",m,"[data-add-to-wishlist]"),r.Z.register("Promotions",p)},8879:()=>{HttpClient.prototype._registerOnLoaded=function(e,t){__superFunc.call(this,e,t),e.addEventListener("loadend",(()=>{if(window.hasOwnProperty("dataLayer")){var t=e.responseText,o=(new DOMParser).parseFromString(t,"text/html"),s=DomAccess.querySelector(o,"#wbm-data-layer",!1);if(s&&window.dataLayer){const e=JSON.parse(s.innerHTML);for(const t in e)if(e.hasOwnProperty(t)&&0!==e[t].length){var i=JSON.parse(e[t]);i.ecommerce&&i.ecommerce.items&&(i.ecommerce.items=i.ecommerce.items.filter((e=>!e.item_id.includes("free-product-")))),"default"===t?window.dataLayer.push(i):WbmDataLayer.push(i)}}}}))}}},e=>{e.O(0,["vendor-node","vendor-shared"],(()=>{return t=2893,e(e.s=t);var t}));e.O()}]);